[["index.html", "Marketing Analytics Lecture Notes Marketing Analytics Lecture Notes", " Marketing Analytics Lecture Notes Marketing Analytics Lecture Notes These notes accompany MKT 4320 Marketing Analytics and are designed to support in-class lectures, demonstrations, and discussion using R and RStudio. The focus of these notes is on understanding why we use particular analytical tools and how to interpret results, rather than on memorizing syntax. "],["examining-and-summarizing-data.html", "Topic 1 Examining and Summarizing Data 1.1 R Packages and Datasets for Topic 1 1.2 Motivation 1.3 Overview 1.4 Univariate - Graphs and Tables 1.5 Univariate - Statistics 1.6 Bivariate - Graphs and Tables 1.7 Statistics 1.8 Suggested Readings", " Topic 1 Examining and Summarizing Data 1.1 R Packages and Datasets for Topic 1 Code library(ggplot2) # Advanced graphing capabilities library(dplyr) # Easier programming library(tidyr) # Easier programming library(sjPlot) # Easily create cross-tabs library(vtable) # Easily create summary tables using &#39;sumtable&#39; library(flextable) library(MKT4320BGSU) data(airlinesat) 1.2 Motivation After data preparation, examining and summarizing the data provides the analyst with a “feel” for the data Distributions of variables Relationships between variables Missing observations Coding of variables 1.3 Overview How we examine and summarize data depends on: Type of data Nominal Ordinal Continuous Number of variables Univariate Bivariate 1.4 Univariate - Graphs and Tables 1.4.1 Bar Chart Primarily for nominal/ordinal data Displays each category’s… Frequency (usually) Centrality Dispersion Figure 1.1: Bar Chart Code airlinesat %&gt;% # Dataset # Group by variable &#39;status&#39; group_by(status) %&gt;% # Create variable &#39;n&#39; equal to number of obs for each status summarize(n=n()) %&gt;% # Create variable &#39;prop&#39; equal to proportion for each status mutate(prop=n/sum(n)) %&gt;% # Begin plot with &#39;status&#39; on x, &#39;prop&#39; on y # &#39;fill=status&#39; gives different color bars for each &#39;status&#39; ggplot(aes(x=status, y=prop, fill=status)) + # Request column chart as the geom function geom_col() + # Add data labels rounded to 1 digit with trailing zeros # Place labels in correct spot with &#39;white&#39; color geom_text(aes(label=format(round(prop*100,1),1)), vjust=1.5, color=&quot;white&quot;) + # Change text size to be larger; remove legend created by &#39;fill&#39; theme(text=element_text(size=15), legend.position=&quot;none&quot;) + # Adds axis labels labs(x=&quot;Status&quot;,y=&quot;Proportion&quot;) 1.4.2 Histogram Non-overlapping categories of equal width from continuous data Shows frequency in each category Used to examine distribution of variable Figure 1.2: Histogram 1 Code airlinesat %&gt;% # Dataset # Begin plot with &#39;age&#39; on x axis ggplot(aes(x=age)) + # Request histogram as geom, binwidth of 2, y represents density geom_histogram(binwidth=2, aes(y=..density..), color=&quot;black&quot;, fill=&quot;tan&quot;) + # Creates normal curve overlay stat_function(fun=function(x) dnorm(x, mean=mean(airlinesat$age), sd=sd(airlinesat$age))) + # Changes text size to be larger theme(text=element_text(size=15)) + # Adds axis labels labs(x=&quot;Age&quot;, y=&quot;Density&quot;) Figure 1.3: Histogram 2 Code airlinesat %&gt;% # Dataset # Drop rows with missing values for variable &#39;s1&#39; drop_na(s1) %&gt;% # Begin plot with &#39;s1&#39; on x axis ggplot(aes(x=s1)) + # Request histogram as geom, binwidth of 2, y represents density # Pick different colors than previous histogram geom_histogram(binwidth=2, aes(y=..density..), color=&quot;saddlebrown&quot;, fill=&quot;orange&quot;) + # Creates normal curve overlay stat_function(fun=function(x) dnorm(x, mean=mean(airlinesat$s1, na.rm=TRUE), sd=sd(airlinesat$s1, na.rm=TRUE))) + # Changes text size to be larger theme(text=element_text(size=15)) + # Adds axis labels labs(x=&quot;Airline gets me there on time (Satisfaction)&quot;, y=&quot;Density&quot;) 1.4.3 Box Plot Displays distribution of continuous data Conveys dispersion information Wider box = More dispersion Can help identify potential outliers How to interpret: Box in middle is the Interquartile Range Q3 (75th percentile) - Q1 (25th percentile) Line in middle is the median Upper/lower lines are upper/lower adjacent values Upper adjacent value is the largest observation that is smaller than Q3 + 1.5*IQR Lower adjacent value is the smallest observation that is larger than Q1 - 1.5*IQR Any observations above (below) the upper (lower) adjacent value are plotted separately, and could be outliers Figure 1.4: Box Plot Code airlinesat %&gt;% # Dataset # Begin plot with no grouping x variable, age as continuous y variable ggplot(aes(x=&quot;&quot;, y=age)) + # Request boxplot as the geom, add whiskers with &#39;staplewidth&#39; geom_boxplot(staplewidth=1) + # Changes text size to be larger theme(text=element_text(size=15)) + # Adds axis labels labs(x=&quot;&quot;, y=&quot;Age&quot;) 1.4.4 Frequency Table Displays counts and percentages for categorical variables Similar to bar chart, but in table form Table 1.1: Frequency Table Code sumtable(airlinesat, &quot;status&quot;, title=NA) # Use package &#39;vtable::sumtable()&#39; Variable N Percent status 1065 … Blue 677 64% … Gold 143 13% … Silver 245 23% 1.5 Univariate - Statistics 1.5.1 Measures of Centrality Values of a “typical” or “average” score Mean is the sum of all observations divided by the number of observations Only appropriate for continuous data Median separates highest and lowers 50% of observations Cannot be used on categorical data 1.5.2 Measures of Dispersion Provide info about variability in the data Range is the highest minus the lowest observation Simple, but includes extreme values Not appropriate for categorical data Interquartile Range (IQR) is Q3 (75th percentile) - Q1 (25th percentile) Used in the Box Plot Not appropriate for categorical data Standard Deviation Given by Equation 1.1 below \\[\\begin{equation} s = \\sqrt{\\frac{\\sum_{i=1}^{n}{(x_i - \\bar{x})^2}}{n-1}} \\tag{1.1} \\end{equation}\\] Only appropriate with continuous data Table 1.2: Measures of Centrality and Dispersion Code sumtable(airlinesat, c(&quot;age&quot;, &quot;s1&quot;), # Data and variables add.median = TRUE, digits = 4) # Add median; request 4 digits Table 1.1: Summary Statistics Variable N Mean Std. Dev. Min Pctl. 25 Pctl. 50 Pctl. 75 Max age 1065 50.42 12.27 19 42 50 58 101 s1 1038 60.91 26.02 1 46 58 84 100 Table 1.3: Measures of Centrality and Dispersion Code # Using dplyr airlinesat %&gt;% # Data # Select variables select(age) %&gt;% # Summarise variables summarise(n = n(), mean = mean(age, na.rm = TRUE), sd = sd(age, na.rm = TRUE), median = median(age, na.rm = TRUE), iqr = IQR(age, na.rm = TRUE), min = min(age, na.rm = TRUE), max = max(age, na.rm = TRUE)) %&gt;% # Pass to flextable for nicer output flextable() .cl-f0a488b4{}.cl-f09e37ca{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f0a09f24{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f0a0b7d4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f0a0b7de{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}nmeansdmedianiqrminmax1,06550.4197212.27464501619101 1.6 Bivariate - Graphs and Tables 1.6.1 Scatterplots Graphically shows how two continuous variables are related If dots appear in to follow a line, variables are likely related (see Figure 1.5) If dots appear random, variables are likely not related (see Figure 1.6) Not appropriate for categorical data (see Figure 1.7) Figure 1.5: Scatterplot 1 with Fitted Line Code airlinesat %&gt;% # Data # Begin plot with x (s18) and y (s17) variables ggplot(aes(x=s18, y=s17)) + # Request scatter plot as geom geom_point() + # Request linear regression fitted line without confidence interval geom_smooth(method=&quot;lm&quot;, se=FALSE) + # Change text size to be larger theme(text=element_text(size=15)) + # Add axis labels labs(x=&quot;Employees are service-oriented (s18)&quot;, y=&quot;Employees are friendly (s17)&quot;) Figure 1.6: Scatterplot 2 without Fitted Line Code airlinesat %&gt;% # Data # Begin plot with x (age) and y (s11) variables ggplot(aes(x=age, y=s11)) + # Request scatter plot geom_point() + # Changes text size to be larger theme(text=element_text(size=15)) + # Adds axis labels labs(x=&quot;Age&quot;, y=&quot;Aircraft interior is well maintained (s11)&quot;) Figure 1.7: Scatterplot of Categorical Data Code airlinesat %&gt;% # Data # Begin plot with x (age) and y (s11) variables ggplot(aes(x=flight_type, y=flight_purpose)) + # Requests scatter plot geom_point() + # Changes text size to be larger theme(text=element_text(size=15)) + # Adds axis labels labs(x=&quot;Flight Type&quot;, y=&quot;Flight Purpose&quot;) 1.6.2 Crosstabs Show if and how two categorical variables are related Common to put “DV” in rows and “IV” in columns Can ask for \\(\\chi^2\\) to test if for significant association Can also view it visually with a stacked bar chart (see Figure 1.8) Percentages represent column percentages Can also view it visually with separate bars for each category (see Figure 1.9) Bar height is percent of total Table 1.4: Crosstab Code # Use package sjPlot to easily create cross-tab tab_xtab(var.row=airlinesat$flight_purpose, # Set row variable var.col=airlinesat$flight_type, # Set column variable show.col.prc=TRUE) # Request column percentages flight_purpose flight_type Total Domestic International Business 33059.1 % 19538.5 % 52549.3 % Leisure 22840.9 % 31261.5 % 54050.7 % Total 558100 % 507100 % 1065100 % χ2=44.619 · df=1 · &amp;phi=0.207 · p=0.000 Figure 1.8: Stacked Bar Chart Code airlinesat %&gt;% # Data # Group data by crosstab variables (column then row) group_by(flight_type, flight_purpose) %&gt;% # Create variable &#39;n&#39; for count of observations in each cell summarise(n=n()) %&gt;% # Create column percentages mutate(prop=100*n/sum(n)) %&gt;% # Begin plot: &#39;type&#39; (x), &#39;prop&#39; (y), &#39;purpose&#39; (fill color) ggplot(aes(x=flight_type, y=prop, fill=flight_purpose)) + # Request column chart as geom geom_col() + # Adds data labels to middle of bars geom_text(aes(label=format(round(prop,1),1)), position=position_stack(vjust=0.5), color=&quot;white&quot;) + # Changes test size to be larger theme(text=element_text(size=15)) + # Adds axis and legend labels labs(x=&quot;Flight Type&quot;, y=&quot;Percent&quot;, fill=&quot;Flight Purpose&quot;) Figure 1.9: Side-by-Side Bar Chart Code airlinesat %&gt;% # Data # Group data by crosstab variables (column, row) group_by(flight_type, flight_purpose) %&gt;% # Create variable &#39;n&#39; for count of observations in each cell # Drop grouping structure to get total percentages summarise(n=n(), .groups=&quot;drop&quot;) %&gt;% # Create total percentages mutate(prop=100*n/sum(n)) %&gt;% # Begin plot: &#39;type&#39; (x), &#39;prop&#39; (y), &#39;purpose&#39; (fill color) ggplot(aes(x=flight_type, y=prop, fill=flight_purpose)) + # Request column chart as geom # Position bars side-by-side instead of stacked geom_col(position = position_dodge(width=.9)) + # Add data labels to end of bars geom_text(aes(label=format(round(prop,1),1)), vjust=1.5, position=position_dodge(width=.9), color=&quot;white&quot;) + # Changes test size to be larger theme(text=element_text(size=15)) + # Adds axis and legend labels labs(x=&quot;Flight Type&quot;, y=&quot;Percent&quot;, fill=&quot;Flight Purpose&quot;) 1.6.3 Box Plot Displays distribution of continuous data across classes of a categorical variable Figure 1.10: Box Plot by Category Code airlinesat %&gt;% # Data # Begin plot with &#39;status&#39; as grouping and &#39;age&#39; as continuous variable ggplot(aes(x=status, y=age)) + # Request boxplot as the geom function with whiskers (&#39;staplewidth&#39;) geom_boxplot(staplewidth=1) + # Changes text size to be larger theme(text=element_text(size=15)) + # Adds axis labels labs(x=&quot;Status&quot;, y=&quot;Age&quot;) 1.6.4 Bar Chart Displays mean (or some other value) of continuous data across classes of a categorical variable Figure 1.11: Bar Chart by Category Code airlinesat %&gt;% # Data # Group data by &#39;status&#39; group_by(status) %&gt;% # Create variable &#39;mean&#39; for mean of &#39;age&#39; by &#39;status&#39; summarise(mean=mean(age)) %&gt;% # Begin plot with &#39;status&#39; on x, &#39;mean&#39; on y ggplot(aes(x=status, y=mean)) + # Requests column chart as geom # Position bars side-by-side instead of stacked # Set fill color to match status geom_col(position=position_dodge(width=.9), fill=c(&quot;midnightblue&quot;,&quot;gold&quot;,&quot;gray&quot;)) + # Sets number of breaks on y-axis scale_y_continuous(n.breaks=6) + # Adds data labels to outside end of bars geom_text(aes(label=format(round(mean,2),2)), vjust=-.5, position=position_dodge(width=.9), color=&quot;black&quot;) + # Changes test size to be larger theme(text=element_text(size=15)) + # Adds axis and legend labels labs(x=&quot;Status&quot;, y=&quot;Mean of Age&quot;) 1.7 Statistics 1.7.1 Correlation Provides a measure of linear association between two continuous variables Given by Equation 1.2 below \\[\\begin{equation} r = \\frac{\\sum_{i=1}^{n}{(x_i - \\bar{x})(y_i-\\bar{y})}}{(n-1)s_xs_y} \\tag{1.2} \\end{equation}\\] \\(-1 \\le r \\le 1\\) Table 1.5: Correlation Matrix Code # Create dataframe of variables to include corrvars &lt;- airlinesat %&gt;% select(age, nflights, e7, s11) # Use package sjPlot to easily create correlation matrix tab_corr(corrvars, na.deletion = &quot;pairwise&quot;, # Delete obs if either variable is missing corr.method = &quot;pearson&quot;, # Choose Pearson correlation coefficient show.p = TRUE, # Show asterisks for significant correlations digits = 3, # Show three decimal points triangle = &quot;lower&quot;, # Show only lower triangle fade.ns=FALSE) # Do not fade insignficant correlations   age nflights e7 s11 age         nflights -0.116***       e7 -0.034 -0.063*     s11 0.170*** -0.106*** 0.240***   Computed correlation used pearson-method with pairwise-deletion. 1.8 Suggested Readings R for Marketing Research and Analytics. 2nd Edition (2019). Chapman, Chris; McDonnel Feit, Elea BGSU Library Link:https://librarysearch.bgsu.edu/permalink/01OHIOLINK_BGSU/i5ro6c/alma9926179903408506 Chapter 3: Describing Data Chapter 4: Relationships Between Continuous Variables Chapter 5: Tables and Visualization OpenIntro Statistics. 4th Edition (2019). Diez, David; Cetinkaya-Rundel, Mine; Barr, Christopher D. Available at OpenIntro.org:https://www.openintro.org/book/os/ Summarizing Data Multivariate Data Analysis. Hair, Joseph F.; Black, William C.; Babin, Barry J.; Anderson, Rolph E. 7th Edition: Search for “multivariate data analysis 7th edition hair” Graphical Examination of the Data (pp. 34-40) 5th Edition: Course reserves Graphical Examination of the Data (pp. 40-46) "],["linear-regression.html", "Topic 2 Linear Regression 2.1 R Packages and Datasets for Topic 2 2.2 Motivation 2.3 Understanding Regression Analysis 2.4 Conducting Linear Regression 2.5 Linear Regression Example 2.6 Categorical IVs 2.7 Categorical IVs Example 2.8 Suggested Readings", " Topic 2 Linear Regression 2.1 R Packages and Datasets for Topic 2 The following packages are used for this topic and are loaded when needed. Code library(ggplot2) # Advanced graphing capabilities library(cowplot) # Arrange separate plots in a grid library(ggtext) # Annotate ggplots library(jtools) # Concise regression results library(dplyr) # Easier programming library(GGally) # Scatterplot Matrix library(vtable) # Summary statistics tables library(MKT4320BGSU) data(advtsales) data(dssales) 2.2 Motivation Regression allows marketers to: Understand relationships between a dependent variable and one or more independent variables Determine the relative strength of different independent variables Make predictions 2.3 Understanding Regression Analysis Regression notation: \\(y = \\alpha + \\beta_kx_k+\\varepsilon\\)        where \\(y\\) is the dependent variable (DV) \\(x_k\\) is the \\(k\\)th independent variable (IV) \\(\\alpha\\) is the constant or \\(y\\)-intercept \\(\\beta_k\\) is the regression coefficient for the \\(k\\)th IV \\(\\varepsilon\\) is the error term Objective Predict DV based on knowledge of the IV(s) Method OLS creates the “best” fitted line by minimizing the sum of the squared residuals OLS Minimizes Equation 2.1 below: \\[\\begin{equation} \\sum_{i=1}^{n}{(y_i - \\hat{y}_i)^2} \\tag{2.1} \\end{equation}\\] Note: The “best” fitted regression line is not always the line that best represents the data 2.4 Conducting Linear Regression 2.4.1 Check Data Requirements Continuous DV Must be measured on an interval or ratio scale For nominal scale, use logistic regression For ordinal scale, use ordinal regression 2.4.2 Model Specification Pick IVs based on… Conceptual grounding Availability of data Including irrelevant IVs… Reduces parsimony May mask effects of other IVs Makes testing significance less precise Excluding relevant IVs… Seriously biases results Negatively affects interpretation 2.4.3 Model Estimation Estimation is typically done using OLS All statistical packages can conduct regression R lm(dv ~ iv1 + iv2 + … + ivk) Stata GUI Statistics &gt; Linear models and related &gt; Linear Regression Stata Command regress dv iv1 iv2 … ivk SPSS GUI Analyze &gt; Regression &gt; Linear SPSS Syntax regression/dependent dv/enter iv1 iv2 … ivk SAS proc reg; model dv = iv1 iv2 … ivk; Minitab Stat &gt; Regression &gt; Regression 2.4.4 Model Interpetation Assessing Overall Model Fit How much variation in the DV is explained by the model Individual Independent Attributes Relationship between DV and each IV \\(H_0:\\beta_k=0\\) vs. \\(H_a:\\beta_k\\ne0\\) Interpret significant relationships Relative strength of IVs 2.4.5 Model Prediction Prediction is a key use of regression Estimate DV based on assumed values of IVs \\(\\hat{y} = \\hat{\\alpha} + \\hat{\\beta_k}x_k\\)        where \\(\\hat{y}\\) is predicted value of \\(y\\) for assumed values of \\(x_k\\)        and Regression provided estimates of \\(\\alpha\\) and \\(\\beta_k\\) 2.5 Linear Regression Example 2.5.1 Overview Advertising and Sales data for 200 firms DV: Sales (in millions), \\(sales\\) IVs: TV Advertising (in 000s), \\(ad\\_tv\\) Radio Advertising (in 000s), \\(ad\\_radio\\) Paper Advertising (in 000s), \\(ad\\_paper\\) Model: \\(sales=\\alpha+\\beta_1ad\\_tv+\\beta_2ad\\_radio+\\beta_3ad\\_paper\\) Goal: Understand the relationship between various advertising types and sales 2.5.2 Summarize Data 2.5.2.1 Univariate Summary Statistics Table 2.1: Summary Statistics Code # Use &#39;sumtable&#39; from &#39;vtable&#39; package # &#39;summ&#39;, &#39;summ.names&#39;, &#39;numformat&#39;, &#39;title&#39; for formatting only sumtable(data=advtsales, vars=c(&quot;ad_paper&quot;, &quot;ad_radio&quot;, &quot;ad_tv&quot;, &quot;sales&quot;), summ=c(&#39;notNA(x)&#39;,&#39;mean(x)&#39;,&#39;sd(x)&#39;,&#39;pctile(x)[50]&#39;,&#39;min(x)&#39;,&#39;max(x)&#39;), summ.names=c(&quot;N&quot;, &quot;Mean&quot;, &quot;Std. Dev&quot;, &quot;Median&quot;, &quot;Min&quot;, &quot;Max&quot;), numformat=label_number(accuracy = .02), title=NA) Variable N Mean Std. Dev Median Min Max ad_paper 200 30.56 21.78 25.76 0.30 114.00 ad_radio 200 23.26 14.84 22.90 0.00 49.60 ad_tv 200 147.04 85.86 149.76 0.70 296.40 sales 200 14.02 5.22 12.90 1.60 27.00 2.5.2.2 Scatterplot and Correlation Matrix Figure 2.1: Scatterplot Matrix with Correlation Code advtsales %&gt;% select(-&quot;id&quot;) %&gt;% # Use package GGally::ggpairs to easily create # combination correlation and scatterplot matrix ggpairs(lower=list(continuous=&quot;smooth&quot;), diag=list(continuous=&quot;blankDiag&quot;)) # Set diagonals to be blank 2.5.2.3 Box Plots Figure 2.2: Box Plots Code # Create box plots for each variable p1 &lt;- ggplot(aes(x=&quot;&quot;, y=ad_tv), data=advtsales) + geom_boxplot(staplewidth = 1) + labs(x=&quot;ad_tv&quot;, y=&quot;&quot;) p2 &lt;- ggplot(aes(x=&quot;&quot;, y=ad_radio), data=advtsales) + geom_boxplot(staplewidth = 1) + labs(x=&quot;ad_radio&quot;, y=&quot;&quot;) p3 &lt;- ggplot(aes(x=&quot;&quot;, y=ad_paper), data=advtsales) + geom_boxplot(staplewidth = 1) + labs(x=&quot;adv_paper&quot;, y=&quot;&quot;) p4 &lt;- ggplot(aes(x=&quot;&quot;, y=sales), data=advtsales) + geom_boxplot(staplewidth = 1) + labs(x=&quot;sales&quot;, y=&quot;&quot;) # Use cowplot::plot_grid() to combine them into single plot plot_grid(p1,p2,p3,p4) 2.5.3 Results 2.5.3.1 Regression Results (Concise) Estimated regression equation: \\(\\hat{sales}=2.939+.046ad\\_tv+.189ad\\_radio-.001ad\\_paper\\) Table 2.2: Regression Results (Concise) Code # Run linear model and save as &#39;results&#39; results &lt;- lm(sales ~ ad_tv + ad_radio + ad_paper, data = advtsales) summ(results, digits=4, model.info=FALSE) F(3,196) 570.2707 R² 0.8972 Adj. R² 0.8956 Est. S.E. t val. p (Intercept) 2.9389 0.3119 9.4223 0.0000 ad_tv 0.0458 0.0014 32.8086 0.0000 ad_radio 0.1885 0.0086 21.8935 0.0000 ad_paper -0.0010 0.0059 -0.1767 0.8599 Standard errors: OLS 2.5.3.2 Standard Results Table 2.3: Regression Results (Standard) Code # Run linear model and save as &#39;results&#39; results &lt;- lm(sales ~ ad_tv + ad_radio + ad_paper, data = advtsales) # Displays results summary(results) Call: lm(formula = sales ~ ad_tv + ad_radio + ad_paper, data = advtsales) Residuals: Min 1Q Median 3Q Max -8.8277 -0.8908 0.2418 1.1893 2.8292 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 2.938889 0.311908 9.422 &lt;2e-16 *** ad_tv 0.045765 0.001395 32.809 &lt;2e-16 *** ad_radio 0.188530 0.008611 21.893 &lt;2e-16 *** ad_paper -0.001037 0.005871 -0.177 0.86 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.686 on 196 degrees of freedom Multiple R-squared: 0.8972, Adjusted R-squared: 0.8956 F-statistic: 570.3 on 3 and 196 DF, p-value: &lt; 2.2e-16 2.5.3.3 Testing Overall Model Significance Relationship between DV and combined effects of IVs \\(H_0:\\beta_1=\\beta_2=\\beta_3=0\\) vs. \\(H_a:\\text{at least one }\\beta_k\\ne0\\) Use \\(F\\)-statistic to test Conclusion: With a \\(F\\)-statistic of \\(570.3\\) and a \\(p\\)-value \\(&lt; 0.001\\), we conclude that at least one \\(\\beta_k\\) is significant 2.5.3.4 Assessing Overall Model Fit How much variation in the DV is explained by the model Use \\(R^2\\) to assess Use \\(\\text{Adjusted }R^2\\) to compare models Conclusion: Based on the \\(R^2\\), about \\(90\\%\\) of the variance in \\(sales\\) is explained by the model 2.5.3.5 Individual Independent Variables Relationship between DV and each IV \\(H_0:\\beta_k=0\\) vs. \\(H_a:\\beta_k\\ne0\\) Interpret significant relationships With a \\(p\\text{-value}&lt;0.001\\), \\(ad\\_tv\\) has a significant effect on sales. A one unit increase in \\(ad_tv\\) is predicted to increases \\(sales\\) by \\(.0457\\) units. With a \\(p\\text{-value}&lt;0.001\\), \\(ad\\_radio\\) has a significant effect on sales. A one unit increase in \\(ad_radio\\) is predicted to increases \\(sales\\) by \\(.1885\\) units. With a \\(p\\text{-value}=.860\\), \\(ad\\_paper\\) has no significant effect on \\(sales\\). Relative strength of IVs For relative strength, use standardized \\(\\beta_k\\)s A standardized \\(\\beta_k\\) is the effect of a single standard deviation change in the IV on the DV Higher absolute values are more important Conclusion: \\(ad\\_tv\\) is the biggest driver of sales Table 2.4: Standardized Beta Coefficients Code # Use &#39;scale = TRUE, transform.response = TRUE&#39; to get standardized betas summ(results, scale = TRUE, transform.response = TRUE, model.info=FALSE, model.fit=FALSE) Est. S.E. t val. p (Intercept) -0.00 0.02 -0.00 1.00 ad_tv 0.75 0.02 32.81 0.00 ad_radio 0.54 0.02 21.89 0.00 ad_paper -0.00 0.02 -0.18 0.86 Standard errors: OLS; Continuous variables are mean-centered and scaled by 1 s.d. Visualize each IV Sometimes it helps to visually examine the IVs for interprtation Plots show predicted DV at different levels of an IV, holding the other IVs constant at the mean value Figure 2.3: Margin Plots Code # Use &#39;easy_mp&#39; from &#39;MKT4320BGSU&#39; to get margin plot # &#39;$plot&#39; returns just the plot # Add better axis lables # Use &#39;ylim()&#39; for same y-axis on all three plots p1 &lt;- easy_mp(results, focal=&quot;ad_tv&quot;)$plot + labs(x=&quot;TV Advertising&quot;, y=&quot;Linear Prediction&quot;) + ylim(5,25) p2 &lt;- easy_mp(results, focal=&quot;ad_radio&quot;)$plot + labs(x=&quot;Radio Advertising&quot;, y=&quot;Linear Prediction&quot;) + ylim(5,25) p3 &lt;- easy_mp(results, focal=&quot;ad_paper&quot;)$plot + labs(x=&quot;Newspaper Advertising&quot;, y=&quot;Linear Prediction&quot;) + ylim(5,25) # Arrange three plots in a grid using package &#39;cowplot&#39; plot_grid(p1,p2,p3) 2.5.3.6 Model Prediction For simplicity, use only \\(ad\\_tv\\) and \\(ad\\_radio\\) Table 2.5: Coefficients Table for Reduced Model Est. S.E. t val. p (Intercept) 2.9211 0.2945 9.9192 0.0000 ad_tv 0.0458 0.0014 32.9087 0.0000 ad_radio 0.1880 0.0080 23.3824 0.0000 Standard errors: OLS \\(\\hat{sales}=2.9211+.0458ad\\_tv+.1880ad\\_radio\\) Predict sales for $100K television advertising and $10K radio advertising \\(\\hat{sales}=2.9211+.0458(100)+.1880(10)=9.381= \\$9,381,000\\) Visually examine prediction at different levels of \\(ad\\_tv\\) and \\(ad\\_radio\\) Figure 2.4: Prediction Plots 2.6 Categorical IVs 2.6.1 Overview May want to represent a qualitative variable… Gender of a buyer Success/Failure Region of the country Special situations …But the IVs are supposed to be continuous Use “dummy” variables to indicate occurrence or nonoccurence of a particular attribute Coded as 1 (usually if true) or 0 (usually if false) Dummy variables can shift the intercept, the slope, or both Intercept Shifter Dummy is only its own term in the model \\(y=\\alpha+\\beta_1x+\\beta_2D\\) Slope Shifter Dummy is only an interaction with another IV \\(y=\\alpha+\\beta_1x+\\beta_2(x\\times D)\\) Intercept and Slope Shifter Dummy is own term and an interaction with IV \\(y=\\alpha+\\beta_1x+\\beta_2D+\\beta_3(x\\times D)\\) 2.6.2 Intercept Shifter \\(D=\\begin{cases}1\\text{ if true}\\\\0\\text{ if false}\\end{cases}\\) Model: \\(y=\\alpha+\\beta_1x+\\beta_2D\\) When \\(D=0\\): \\(\\begin{array}{rcl}y &amp; = &amp; \\alpha+\\beta_1x+\\beta_2(0)\\\\&amp; = &amp; \\alpha + \\beta_1x\\end{array}\\) When \\(D=1\\): \\(\\begin{array}{rcl}y &amp; = &amp; \\alpha+\\beta_1x+\\beta_2(1)\\\\&amp; = &amp; (\\alpha + \\beta_2)+\\beta_1x\\end{array}\\) 2.6.3 Slope Shifter \\(D=\\begin{cases}1\\text{ if true}\\\\0\\text{ if false}\\end{cases}\\) Model: \\(y=\\alpha+\\beta_1x+\\beta_2(x\\times D)\\) When \\(D=0\\): \\(\\begin{array}{rcl}y &amp; = &amp; \\alpha+\\beta_1x+\\beta_2(x\\times 0)\\\\&amp; = &amp; \\alpha + \\beta_1x\\end{array}\\) When \\(D=1\\): \\(\\begin{array}{rcl}y &amp; = &amp; \\alpha+\\beta_1x+\\beta_2(x\\times 1)\\\\&amp; = &amp; \\alpha + (\\beta_1+\\beta_2)x\\end{array}\\) Unusual to see only a slope shift 2.6.4 Intercept and Slope Shifter \\(D=\\begin{cases}1\\text{ if true}\\\\0\\text{ if false}\\end{cases}\\) Model: \\(y=\\alpha+\\beta_1x+\\beta_2D+\\beta_3(x\\times D)\\) When \\(D=0\\): \\(\\begin{array}{rcl}y &amp; = &amp; \\alpha+\\beta_1x+\\beta_2(0)+\\beta_3(x\\times 0)\\\\&amp; = &amp; \\alpha + \\beta_1x\\end{array}\\) When \\(D=1\\): \\(\\begin{array}{rcl}y &amp; = &amp; \\alpha+\\beta_1x+\\beta_2(1)+\\beta_3(x\\times 1)\\\\&amp; = &amp; (\\alpha + \\beta_2) + (\\beta_1 + \\beta_3)x\\end{array}\\) 2.6.5 Multiple Levels What if categorical IV has multiple levels (e.g., quarters)? Choose one level to be the base Create dummy variables for the other levels Levels must be mutually exclusive Dummy variables for four levels: Level 1, \\(L_1=\\begin{cases}1\\text{ if true}\\\\0\\text{ if false}\\end{cases}\\) Level 2, \\(L_2=\\begin{cases}1\\text{ if true}\\\\0\\text{ if false}\\end{cases}\\) Level 3, \\(L_3=\\begin{cases}1\\text{ if true}\\\\0\\text{ if false}\\end{cases}\\) Level 4, \\(L_4=\\text{base level; is true when }L_1=L_2=L_3=0\\) Model: \\(y=\\alpha + \\beta_1x + \\beta_2L_1+\\beta_3L_2+\\beta_4L_3\\) When Level 1: \\(\\begin{array}{rcl}y &amp; = &amp; \\alpha+\\beta_1x+\\beta_2(1)+\\beta_3(0)+\\beta_4(0)\\\\&amp; = &amp; (\\alpha + \\beta_2) + \\beta_1x\\end{array}\\) When Level 2: \\(\\begin{array}{rcl}y &amp; = &amp; \\alpha+\\beta_1x+\\beta_2(0)+\\beta_3(1)+\\beta_4(0)\\\\&amp; = &amp; (\\alpha + \\beta_3) + \\beta_1x\\end{array}\\) When Level 3: \\(\\begin{array}{rcl}y &amp; = &amp; \\alpha+\\beta_1x+\\beta_2(0)+\\beta_3(0)+\\beta_4(1)\\\\&amp; = &amp; (\\alpha + \\beta_4) + \\beta_1x\\end{array}\\) When Level 4: \\(\\begin{array}{rcl}y &amp; = &amp; \\alpha+\\beta_1x+\\beta_2(0)+\\beta_3(0)+\\beta_4(0)\\\\&amp; = &amp; \\alpha + \\beta_1x\\end{array}\\) 2.7 Categorical IVs Example 2.7.1 Overview Sales data for 28 department store locations across 47 weeks and 69 departments DV: Department Sales, \\(sales\\) IVs: Overall Store Size, \\(size\\) Week, \\(week\\) where 1 = \\(week\\) ending 11/11/11 Predict sales by department Believe that the “holiday” season (or quarter 4) will be a driver of sales for some departments Generate dummy variable: \\(q4=\\begin{cases}1\\text{ if }week\\text{ in Quarter 4}\\\\0\\text{ otherwise}\\end{cases}\\) 2.7.2 Intercept Shift \\(sales = \\alpha + \\beta_1size+\\beta_2q4\\) Results: \\(sales\\) are significantly lower in Q4 (see Table 2.6 and Figure 2.5) Table 2.6: Regression Results (Intercept Shfit) for One Department F(2,1090) 126.1302 R² 0.1879 Adj. R² 0.1864 Est. S.E. t val. p (Intercept) 9993.3892 1890.0317 5.2874 0.0000 size 0.0546 0.0107 5.1210 0.0000 q4Yes -15153.3589 1012.8597 -14.9610 0.0000 Standard errors: OLS Figure 2.5: Margin Plot for Intercept Shifter Code # Use &#39;easy_mp&#39; to create margin plot, &#39;$plot&#39; returns only plot easy_mp(mod.is, focal=&quot;size&quot;, int=&quot;q4&quot;)$plot + # Nicer axis labels labs(y=&quot;Linear Prediction&quot;, x=&quot;Size&quot;, fill=&quot;Q4&quot;, color=&quot;Q4&quot;) + # Add annotations (not necessary usually) geom_segment(aes(x=145000, y=2758.8147, xend=145000, yend=17912.1735), color=&quot;black&quot;, size=1, arrow=arrow(ends=&quot;both&quot;)) + geom_richtext(x=173000, y=10000, label=&quot;&lt;i&gt;&amp;beta;&lt;/i&gt;&lt;sub&gt;2&lt;/sub&gt; = –15153.36&quot;, color=&quot;black&quot;,label.color=NA, size=8, fill=NA, family=&quot;serif&quot;) 2.7.3 Slope Shift \\(sales = \\alpha + \\beta_1size+\\beta_2(size\\times q4)\\) Results: \\(sales\\) as a function of \\(size\\) are significantly lower in Q4 (see Table 2.7 and Figure 2.6) Table 2.7: Regression Results (Slope Shift) for One Department F(2,1090) 128.2440 R² 0.1905 Adj. R² 0.1890 Est. S.E. t val. p (Intercept) 6568.3795 1870.6049 3.5114 0.0005 size 0.0742 0.0107 6.9309 0.0000 size:q4Yes -0.0872 0.0058 -15.0986 0.0000 Standard errors: OLS Figure 2.6: Margin Plot for Slope Shifter Code # Use &#39;easy_mp&#39; to create margin plot, &#39;$plot&#39; returns only plot easy_mp(mod.ss, focal=&quot;size&quot;, int=&quot;q4&quot;)$plot + # Nicer axis labels labs(y=&quot;Linear Prediction&quot;, x=&quot;Size&quot;, fill=&quot;Q4&quot;, color=&quot;Q4&quot;) + # Add annotations (not necessary usually) geom_segment(aes(x=85000, y=12877.117, xend=85000, yend=19000), color=&quot;black&quot;, size=1, arrow=arrow(ends=&quot;last&quot;)) + geom_richtext(x=105000, y=20000, label=&quot;Slope = &lt;i&gt;&amp;beta;&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt; = .0742&quot;, color=&quot;black&quot;,label.color=NA, size=8, fill=NA, family=&quot;serif&quot;) + geom_segment(aes(x=85000, y=-500, xend=85000, yend=5461.182), color=&quot;black&quot;, size=1, arrow=arrow(ends=&quot;first&quot;)) + geom_richtext(x=118000, y=-2000, label=&quot;Slope = &lt;i&gt;&amp;beta;&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt; + &lt;i&gt;&amp;beta;&lt;/i&gt;&lt;sub&gt;2&lt;/sub&gt; = –.0130&quot;, color=&quot;black&quot;,label.color=NA, size=8, fill=NA, family=&quot;serif&quot;) + # Change &#39;ylim&#39; just to fit annotation on plot ylim(-5000,25000) 2.7.4 Intercept and Slope Shift \\(sales = \\alpha + \\beta_1size+\\beta_2q4+\\beta_3(size\\times q4)\\) Results: \\(sales\\) as a function of \\(size\\) are significantly lower in Q4 (see Table 2.8 and Figures 2.7 and 2.8) Table 2.8: Regression Results (Intercept &amp; Slope Shift) for One Department F(3,1089) 86.0379 R² 0.1916 Adj. R² 0.1894 Est. S.E. t val. p (Intercept) 7811.3235 2126.7243 3.6729 0.0003 size 0.0673 0.0121 5.5712 0.0000 q4Yes -5482.4234 4466.5447 -1.2274 0.2199 size:q4Yes -0.0567 0.0255 -2.2229 0.0264 Standard errors: OLS Figure 2.7: Margin Plot for Intercept and Slope Shifter Showing \\(y\\)-intercept Code # Using rarely used option &#39;focal_range&#39; and &#39;ci&#39; easy_mp(mod.iss, focal=&quot;size&quot;, int=&quot;q4&quot;, focal_range=c(0,220000), ci=FALSE)$plot + # Nicer axis labels labs(y=&quot;Linear Prediction&quot;, x=&quot;Size&quot;, fill=&quot;Q4&quot;, color=&quot;Q4&quot;) + # Add annotations (not necessary usually) geom_segment(aes(x=0, y=2328.900, xend=0, yend=7811.323), color=&quot;black&quot;, size=1, arrow=arrow(ends=&quot;both&quot;)) + geom_richtext(x=40000, y=5000, label=&quot;&lt;i&gt;&amp;beta;&lt;/i&gt;&lt;sub&gt;2&lt;/sub&gt; = –5482.42&quot;, color=&quot;black&quot;,label.color=NA, size=8, fill=NA, family=&quot;serif&quot;) Figure 2.8: Margin Plot for Intercept and Slope Shifter Code # Use &#39;easy_mp&#39; to create margin plot, &#39;$plot&#39; returns only plot easy_mp(mod.iss, focal=&quot;size&quot;, int=&quot;q4&quot;)$plot + # Nicer axis labels labs(y=&quot;Linear Prediction&quot;, x=&quot;Size&quot;, fill=&quot;Q4&quot;, color=&quot;Q4&quot;) + # Add annotations (not necessary usually) geom_segment(aes(x=85000, y=13534.849, xend=85000, yend=19000), color=&quot;black&quot;, size=1, arrow=arrow(ends=&quot;last&quot;)) + geom_richtext(x=105000, y=20000, label=&quot;Slope = &lt;i&gt;&amp;beta;&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt; = .0673&quot;, color=&quot;black&quot;,label.color=NA, size=8, fill=NA, family=&quot;serif&quot;) + geom_segment(aes(x=85000, y=-1500, xend=85000, yend=3230.153), color=&quot;black&quot;, size=1, arrow=arrow(ends=&quot;first&quot;)) + geom_richtext(x=113000, y=-3000, label=&quot;Slope = &lt;i&gt;&amp;beta;&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt; + &lt;i&gt;&amp;beta;&lt;/i&gt;&lt;sub&gt;2&lt;/sub&gt; = .0106&quot;, color=&quot;black&quot;,label.color=NA, size=8, fill=NA, family=&quot;serif&quot;) + # Change &#39;ylim&#39; just to fit annotation on plot ylim(-5000,25000) 2.7.5 Intercept Shift with Multiple Levels \\(sales=\\alpha+\\beta_1size+\\beta_2q1+\\beta_3q2+\\beta_4q3\\) Q4 is set as the base level Results: \\(sales\\) are significantly lower in Q4 than in each of the other three quarters (see Table 2.9 and Figures 2.9 and 2.10) Table 2.9: Regression Results (Intercept Shift for Multiple Levels) for One Department F(4,1088) 307.2426 R² 0.5304 Adj. R² 0.5287 Est. S.E. t val. p (Intercept) -5354.0323 1539.7359 -3.4772 0.0005 size 0.0558 0.0081 6.8680 0.0000 quarter1 7268.7033 904.6239 8.0351 0.0000 quarter2 31313.5153 963.9526 32.4845 0.0000 quarter3 10436.9137 917.0085 11.3815 0.0000 Standard errors: OLS Figure 2.9: Margin Plot for Multiple Levels Showing \\(y\\)-intercept Code easy_mp(mod.mis, focal=&quot;size&quot;, int=&quot;quarter&quot;, focal_range=c(0,240000))$plot + # Nicer axis labels labs(y=&quot;Linear Prediction&quot;, x=&quot;Size&quot;, fill=&quot;Q4&quot;, color=&quot;Q4&quot;) + # Expand axes for annotations; NOT USUALLY NECESSARY scale_x_continuous(breaks=seq(0,240000,40000), expand=expansion(mult=c(.2,.4)), minor_breaks=NULL) + scale_y_continuous(limits=c(-10000,45000), expand=c(.025,.025), breaks=seq(-10000,40000,10000), minor_breaks=NULL) + # Add annotations; NOT USUALLY NECESSARY geom_richtext(x=0, y=-5354.0323, label=&quot;&lt;i&gt;&amp;alpha;&lt;/i&gt;&quot;, color=&quot;black&quot;,label.color=NA, size=6, fill=NA, family=&quot;serif&quot;, hjust=1) + geom_richtext(x=0, y=1914.6710, label=&quot;&lt;i&gt;&amp;alpha;&lt;/i&gt;+ &lt;i&gt;&amp;beta;&lt;sub&gt;2&lt;/sub&gt;&quot;, color=&quot;black&quot;,label.color=NA, size=6, fill=NA, family=&quot;serif&quot;, hjust=1) + geom_richtext(x=0, y=5082.8814, label=&quot;&lt;i&gt;&amp;alpha;&lt;/i&gt;+ &lt;i&gt;&amp;beta;&lt;sub&gt;4&lt;/sub&gt;&quot;, color=&quot;black&quot;,label.color=NA, size=6, fill=NA, family=&quot;serif&quot;, hjust=1) + geom_richtext(x=0, y=25959.4830, label=&quot;&lt;i&gt;&amp;alpha;&lt;/i&gt;+ &lt;i&gt;&amp;beta;&lt;sub&gt;3&lt;/sub&gt;&quot;, color=&quot;black&quot;,label.color=NA, size=6, fill=NA, family=&quot;serif&quot;, hjust=1) + geom_richtext(x=240000, y=8026.6254, label=&quot;&lt;i&gt;q&lt;/i&gt;4 (&lt;i&gt;q&lt;/i&gt;1=&lt;i&gt;q&lt;/i&gt;2=&lt;i&gt;q&lt;/i&gt;3=0)&quot;, color=&quot;black&quot;,label.color=NA, size=4, fill=NA, family=&quot;serif&quot;, hjust=0) + geom_richtext(x=240000, y=15295.3287, label=&quot;&lt;i&gt;q&lt;/i&gt;1 (&lt;i&gt;q&lt;/i&gt;1=1, &lt;i&gt;q&lt;/i&gt;2=&lt;i&gt;q&lt;/i&gt;3=0)&quot;, color=&quot;black&quot;,label.color=NA, size=4, fill=NA, family=&quot;serif&quot;, hjust=0) + geom_richtext(x=240000, y=18463.5391, label=&quot;&lt;i&gt;q&lt;/i&gt;3 (&lt;i&gt;q&lt;/i&gt;3=1, &lt;i&gt;q&lt;/i&gt;1=&lt;i&gt;q&lt;/i&gt;2=0)&quot;, color=&quot;black&quot;,label.color=NA, size=4, fill=NA, family=&quot;serif&quot;, hjust=0) + geom_richtext(x=240000, y=39340.1407, label=&quot;&lt;i&gt;q&lt;/i&gt;2 (&lt;i&gt;q&lt;/i&gt;2=1, &lt;i&gt;q&lt;/i&gt;1=&lt;i&gt;q&lt;/i&gt;3=0)&quot;, color=&quot;black&quot;,label.color=NA, size=4, fill=NA, family=&quot;serif&quot;, hjust=0) + # Reorder legend scale_fill_discrete(breaks=c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;)) + scale_color_discrete(breaks=c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;)) Figure 2.10: Margin Plot for Multiple Levels Code easy_mp(mod.mis, focal=&quot;size&quot;, int=&quot;quarter&quot;, ci=FALSE)$plot + # Nicer axis labels labs(y=&quot;Linear Prediction&quot;, x=&quot;Size&quot;, fill=&quot;Q4&quot;, color=&quot;Q4&quot;) + # Add annotations; NOT USUALLY NECESSARY geom_segment(aes(x=70000, y=-1451.3405, xend=70000, yend=5817.3628), color=&quot;black&quot;, size=1, arrow=arrow(ends=&quot;both&quot;)) + geom_richtext(x=74000, y=2500, label=&quot;&lt;i&gt;&amp;beta;&lt;/i&gt;&lt;sub&gt;2&lt;/sub&gt; = 7268.70&quot;, color=&quot;black&quot;,label.color=NA, size=5, fill=NA, family=&quot;serif&quot;, hjust=0, angle=3.19109) + geom_segment(aes(x=115000, y=1057.5329, xend=115000, yend=11494.4465), color=&quot;black&quot;, size=1, arrow=arrow(ends=&quot;both&quot;)) + geom_richtext(x=116000, y=6000, label=&quot;&lt;i&gt;&amp;beta;&lt;/i&gt;&lt;sub&gt;4&lt;/sub&gt; = 10436.91&quot;, color=&quot;black&quot;,label.color=NA, size=5, fill=NA, family=&quot;serif&quot;, hjust=0, angle=3.19109) + geom_segment(aes(x=160000, y=3566.4062, xend=160000, yend=34879.9214), color=&quot;black&quot;, size=1, arrow=arrow(ends=&quot;both&quot;)) + geom_richtext(x=161000, y=20000, label=&quot;&lt;i&gt;&amp;beta;&lt;/i&gt;&lt;sub&gt;3&lt;/sub&gt; = 31313.52&quot;, color=&quot;black&quot;,label.color=NA, size=5, fill=NA, family=&quot;serif&quot;, hjust=0, angle=3.19109) + # Reorder legend scale_fill_discrete(breaks=c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;)) + scale_color_discrete(breaks=c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;)) 2.8 Suggested Readings R for Marketing Research and Analytics. 2nd Edition (2019). Chapman, Chris; McDonnel Feit, Elea BGSU Library Link:https://librarysearch.bgsu.edu/permalink/01OHIOLINK_BGSU/i5ro6c/alma9926179903408506 Chapter 7 OpenIntro Statistics. 4th Edition (2019). Diez, David; Cetinkaya-Rundel, Mine; Barr, Christopher D. Available at OpenIntro.org:https://www.openintro.org/book/os/ Chapter 8: Introduction to linear regression Chapter 9: Multiple and logistic regression Multivariate Data Analysis. Hair, Joseph F.; Black, William C.; Babin, Barry J.; Anderson, Rolph E. 7th Edition: Search for “multivariate data analysis 7th edition hair” Chapter 4: Multiple Regression Analysis 5th Edition: Course reserves Chapter 4: Multiple Regression Analysis "],["logistic-regression.html", "Topic 3 Logistic Regression 3.1 R Packages and Datasets for Topic 3 3.2 Motivation 3.3 Why not use linear regression? 3.4 Understanding Logistic Regression 3.5 Conducting Logistic Regression 3.6 Logistic Regression Example 3.7 Suggested Readings", " Topic 3 Logistic Regression 3.1 R Packages and Datasets for Topic 3 Code library(ggplot2) # Advanced graphing capabilities library(cowplot) # Plots in grid library(tidyr) # Easier programming library(flextable) # Better looking tables library(jtools) # Concise regression results library(dplyr) # Easier programming library(MKT4320BGSU) data(directmktg) 3.2 Motivation Marketers often observe binary outcomes Did a customer: purchase? subscribe? renew? respond? Using linear regression is not appropriate… …But logistic regression still allows us to: Understand IV/DV relationships Make predictions 3.3 Why not use linear regression? Want to see how \\(age\\) affects \\(buy\\) \\(buy=\\begin{cases}1\\text{ if yes/true}\\\\0\\text{ if no/false}\\end{cases}\\) Examine relationship with a scatterplot What do we see? Figure 3.1: Scatterplot with Binary DV Code directmktg %&gt;% # Data # Create numeric 0,1 variable for factor variable &quot;buy&quot; mutate(buy01=as.numeric(buy)-1) %&gt;% # Send to ggplot ggplot(aes(x=age, y=buy01)) + geom_point(size=3, color=&quot;red&quot;) + theme(text=element_text(size=15)) + labs(x=&quot;Age&quot;, y=&quot;Buy&quot;) Try linear regression: \\(buy=\\alpha+\\beta_1 age\\) Table 3.1: Linear Regression Results Code model &lt;- directmktg %&gt;% mutate(buy=as.numeric(buy)-1) %&gt;% lm(buy ~ age, .) summ(model, model.info=FALSE, digits=4) F(1,398) 251.7421 R² 0.3874 Adj. R² 0.3859 Est. S.E. t val. p (Intercept) -0.7154 0.0702 -10.1930 0.0000 age 0.0285 0.0018 15.8664 0.0000 Standard errors: OLS Good \\(R^2\\) and \\(age\\) is highly significant So what’s the problem? Predict \\(buy\\) from linear regression results: \\(\\hat{buy}=-.7154+.0285age\\) Prediction line shown in plot Figure 3.2: Predicted Values from Linear Regression Code directmktg %&gt;% select(age) %&gt;% mutate(yhat=predict(model,.)) %&gt;% mutate(neg=as.factor(ifelse(yhat&lt;0,&quot;Yes&quot;,&quot;No&quot;))) %&gt;% ggplot(aes(x=age, y=yhat, color=neg)) + geom_point(size=3) + scale_color_manual(values=c(&quot;Yes&quot;=&quot;red&quot;, &quot;No&quot;=&quot;black&quot;), guide=&quot;none&quot;) + theme(text=element_text(size=15)) + labs(x=&quot;Age&quot;, y=&quot;Linear Prediction&quot;) Add \\(age\\) categories and plot mean \\(buy\\) for each category * What “shape” does this resemble? * Can we use this “shape” to model the relationship? Figure 3.3: Buy for Age Groups Code # Create data frame grouped by age dmgrp &lt;- directmktg %&gt;% # &#39;cut&#39; breaks a continuous variable into groups of each width # &#39;as.numeric&#39; keeps the new variable as integer (vs. factor) mutate(agegrp = as.numeric(cut(age, 9))) %&gt;% group_by(agegrp) %&gt;% summarise(age=mean(age), buy=mean(as.numeric(buy)-1)) # Run logistic model to create prediction to make s-curve binmod &lt;- glm(buy~age, directmktg, family=&quot;binomial&quot;) # Create dataframe with predicted values dmpred &lt;- directmktg %&gt;% select(age, buy) %&gt;% mutate(yhat=predict(binmod, type=&quot;response&quot;), buy=as.numeric(buy)-1) # Create combined plot; each geom with separate data ggplot() + geom_point(data=directmktg, aes(x=age, y=(as.numeric(buy)-1)), size=3, color=&quot;red&quot;) + geom_line(data=dmgrp, aes(x=age, y=buy), size=1.5, color=&quot;midnightblue&quot;) + geom_line(data=dmpred, aes(x=age, y=yhat), size=1.5, color=&quot;darkorange&quot;) + theme(text=element_text(size=15)) + labs(x=&quot;Age&quot;, y=&quot;Buy&quot;) 3.4 Understanding Logistic Regression Uses the logistic function: \\(f(z)=\\frac{e^u}{1+e^u}\\) \\(f(z)\\) is the probability of event happening When \\(u=0\\), \\(f(z)=\\frac{e^0}{1+e^0}=\\frac{1}{1+1}=0.5\\) \\(u\\) is a linear function, such as: \\(\\alpha+\\beta x\\) Ensures predictions are never above 1 or below 0 Figure 3.4: Logistic Function Code # Create simulated data frame based on logistic function u=seq(-7,7,.05) fz=exp(u)/(1+exp(u)) ufz=data.frame(u=u, fz=fz) # Plot function ufz %&gt;% ggplot(aes(x=u, y=fz)) + geom_line(color=&quot;darkorange&quot;, size=1.5) + theme(text=element_text(size=15), panel.grid.major.x = element_blank()) + scale_x_continuous(breaks=0, minor_breaks=NULL) + scale_y_continuous(breaks=seq(0,1,1), minor_breaks=NULL) + labs(x=&quot;u&quot;, y=&quot;f(z)&quot;) + annotate(&quot;segment&quot;, x=0, y=0, xend=0, yend=0.5, linewidth = 1, color=&quot;red&quot;) + annotate(&quot;segment&quot;, x=-7, y=0.5, xend=0, yend=0.5, linewidth = 1, color=&quot;red&quot;) Probability of event success vs. failure \\(=\\frac{f(z)}{1-f(z)}=\\) Odds Ratio (\\(OR\\)) Suppose probability of success \\(=.01\\), then: \\(OR=\\frac{.01}{1-.01}=.0101\\) Suppose probability of success \\(=.001\\), then: \\(OR=\\frac{.001}{1-.001}=.0010\\) Suppose probability of success \\(=.99\\), then: \\(OR=\\frac{.99}{1-.99}=99\\) Suppose probability of success \\(=.999\\), then: \\(OR=\\frac{.999}{1-.999}=999\\) Suppose probability of success \\(=.5\\), then: \\(OR=\\frac{.5}{1-.5}=1\\) Substituting logistic function for \\(f(z)\\) into Odds Ratio \\(\\Rightarrow\\) \\(OR=e^u=e^{\\alpha+betax}\\) \\(\\frac{f(z)}{1-f(z)}=\\frac{\\frac{e^u}{1+e^u}}{1-\\frac{e^u}{1+e^u}}=\\frac{\\frac{e^u}{1+e^u}}{\\frac{1+e^u}{1+e^u}-\\frac{e^u}{1+e^u}}=\\frac{\\frac{e^u}{1+e^u}}{\\frac{1}{1+e^u}}=e^u\\) Can transform exponential function into linear \\(\\Rightarrow\\) \\(Logit=\\ln(OR)=\\alpha+\\beta x\\) 3.5 Conducting Logistic Regression Model Estimation Assessing Model Fit Goodness of Fit Measures Classification Matrix ROC Curve Interpreting Coefficients Gains and Lift 3.5.1 Model Estimation Best to use training data and holdout data Estimate model on training data (~75% of sample) Check prediction accuracy on holdout data (~25%) Can estimate either (1) \\(OR\\) or (2) \\(Logit\\) formulation \\(OR=e^{\\alpha+\\beta_1x_1+\\cdots+\\beta_kx_k}\\) \\(Logit=\\alpha+\\beta_1x_1+\\cdots+\\beta_kx_k\\) Independent variables: Can be one or more Can be continuous or categorical/factor 3.5.2 Assessing Model Fit 3.5.2.1 Goodness-of-Fit Measures Overall significance based on \\(-2LL\\) Lower (closer to \\(0\\)) \\(-2LL\\) indicates a better fit Compare \\(-2LL\\) of estimated model with “null” model McFadden’s Pseudo-\\(R^2\\) Values range from 0 to 1 like linear regression Interpreted in a similar manner Amount of variation in DV explained by IVs 3.5.2.2 Classification Matrix How does the model do in predicting outcomes? Generate predicted probability of success, \\(p(\\text{SUCCESS})\\), for each observation If \\(p(\\text{SUCCESS})\\ge0.5\\), predict \\(\\text{SUCCESS}=1\\) If \\(p(\\text{SUCCESS})&lt;0.5\\), predict \\(\\text{SUCCESS}=0\\), or \\(\\text{FAILURE}\\) Check predictions against actual outcomes Examine both training and holdout data Figure 3.5: Classification Matrix Four main measures Sensitivity: Predicted success given actual success \\(p(\\hat{+}|+)=a/(a+c)\\) “Of all the people who actually had the outcome, how many did we predict correctly?” Specificity: Predicted failure given actual failure \\(p(\\hat{-}|-)=d/(b+d)\\) “Of all the people who didn’t actually have the outcome, how many did we predict correctly?” Precision: Proportion of positive predictions actually correct \\(a/(a+b)\\) “Of all the times predicted the outcome, how many were correct? Overall correctly classified \\((a+d)/(a+b+c+d)\\) Sensitivity vs. Specificity Ideally, want both to be high, but… the \\(p(\\text{SUCCESS})\\ge\\pi\\) threshold can be changed Why change \\(\\pi\\)? Avoid false positives or negatives By default: Increasing sensitivity decreases specificity Increasing specificity decreases sensitivity Visualizing sensitivity and specificity Overall correctly classified Compare with Proportional Chance Criterion (\\(PCC\\)) \\(PCC\\) is the “average” probability of classification based on group sizes \\(PCC=p^2+(1-p)^2\\) where \\(p\\) is the proportion of sample in the \\(\\text{SUCCESS}\\) group Overall correctly classified \\(&gt;PCC\\) considered good fit when examining holdout data 3.5.2.3 ROC Curve Plot sensitivity by \\(1-\\) specificity as \\(\\pi\\) goes from \\(0\\) to \\(1\\) More area under curve means better model Area under Curve Discrimination AUC = .5 None .5 &lt; AUC &lt; .7 Poor .7 ≤ AUC &lt; .8 Acceptable .8 ≤ AUC &lt; .9 Excellent AUC ≥ .9 Outstanding Figure 3.6: Sample ROC Curve Code spec &lt;- seq(0,1,.001) sens &lt;- sqrt(1-spec^2) df &lt;- data.frame(spec,sens) data.frame(spec,sens) %&gt;% mutate(sens=ifelse(sens&gt;1,1,sens)) %&gt;% mutate(sens=ifelse(sens&lt;0,0,sens)) %&gt;% ggplot(aes(x=spec, y=sens)) + geom_line(color=&quot;darkorange&quot;, size=2) + scale_x_reverse() + geom_segment(x=-1, y=0, xend=0, yend=1, color=&quot;forestgreen&quot;, size=2) + geom_segment(x=-.495, y=.495, xend=-.375, yend=.375, arrow=arrow(ends=&quot;first&quot;)) + annotate(&quot;text&quot;, x=.375, y=.35, label=&quot;Chance Model&quot;, size=6) + theme(text=element_text(size=15)) + labs(x=&quot;Specificity&quot;, y=&quot;Sensitivity&quot;) 3.5.3 Interpreting Coefficients Relationship between DV and each IV \\(H_0: \\beta_k=0\\) vs. \\(H_a: \\beta_k\\ne0\\) Interpret significant relationships Interpretation depends on \\(OR\\) or \\(Logit\\) estimation Direction of relationship: \\(Logit\\) estimation: \\(\\beta_k&gt;0\\) for positive, \\(\\beta_k&lt;0\\) for negative \\(OR\\) estimation: \\(\\beta_k&gt;1\\) for positive, \\(\\beta_k&lt;1\\) for negative Magnitude of change: \\(Logit\\) estimation: coefficients are not particularly useful \\(OR\\) estimation: Percentage change in odds Compare probabilities between groups Interaction of continuous IV and dummy IV \\(Logit=\\alpha+\\beta_1x_1+\\beta_2D+\\beta_3(x_1\\times D)\\) When \\(D=0\\), \\(Logit=\\alpha+\\beta_1x_1\\), so:\\(OR(x_1)=e^{\\beta_1}\\) When \\(D=1\\), \\(Logit=(\\alpha+\\beta_2)+(\\beta_1+\\beta_3)x_1\\), so:\\(OR(x_1)=e^{(\\beta_1+\\beta_3)}\\) 3.5.4 Gain and Lift Evaluate performance of classification Example: Suppose \\(10\\%\\) of \\(2000\\) customers will accept offer For \\(100\\) random customers, expect \\(10\\) accepted offers Model predicts some customers more likely to accept Instead of contacting \\(100\\) random customers…Contact \\(100\\) most likely to accept based on model Continue doing this in groups of \\(100\\) (or \\(200\\), etc.) Gain and lift provide measures of how much better the model performs vs. no model/random Process Predict \\(p(\\text{SUCCESS})\\) for each observation and sort descending Split into 10 (deciles) or 20 (demi-deciles) ordered groups Calculate \\(\\%\\) observations and \\(\\%\\) successes for each group 3.5.4.1 Gain Cumulative successes up to that group divided by total successes across all groups Plot on \\(y\\)-axis, with cumulative percent of observations on \\(x\\)-axis Example: Supposed out of 2000 customers, 200 (or 10%) will ultimately buy If we randomly contact 20% (or 400), how many buyers would be expect? 20% of 200 total buyers = 40 buyers What if we contact the top 20% most likely to buy? Get about 55% of ultimate buyers… 55% of 200 total buyers = 110 buyers We “gained” 35% or 70 buyers Figure 3.7: Typical Gain Chart Shape Code pcc &lt;- seq(.05,1,.01) pcp &lt;- .3376*log(pcc)+1.0944 data.frame(pcc,pcp) %&gt;% mutate(pcp=ifelse(pcp&gt;1,1,pcp)) %&gt;% ggplot(aes(x=pcc, y=pcp)) + geom_line(color=&quot;midnightblue&quot;, size=1) + scale_x_continuous(&quot;Proportion Customers Contacted&quot;, limits=c(.05,1), breaks=seq(.1,1,.1)) + scale_y_continuous(&quot;Proportion Customers Positive&quot;, limits=c(.05,1), breaks=seq(.1,1,.1)) + geom_segment(x=.05, y=.05, xend=1, yend=1, color=&quot;red&quot;, size=1) + geom_segment(x=.9, y=.775, xend=.9, yend=.895, arrow=arrow(ends=&quot;last&quot;)) + annotate(&quot;text&quot;, x=.9, y=.765, label=&quot;Baseline Model&quot;, size=5) + theme(text=element_text(size=15)) + geom_segment(x=.2, y=0, xend=.2, yend=.55105376, linetype=2, color=&quot;darkorange&quot;, size=.75) + geom_segment(x=0, y=.2, xend=.2, yend=.2, linetype=2, color=&quot;darkorange&quot;, size=.75) + geom_segment(x=0, y=.55105376, xend=.2, yend=.55105376, linetype=2, color=&quot;darkorange&quot;, size=.75) 3.5.4.2 Lift Ratio of cumulative success up to that group divided by expected success from no model Plot on \\(y\\)-axis, with cumulative percent of observations on \\(x\\)-axis Figure 3.8: Typical Lift Chart Shape Code lift &lt;- 2.7863*pcc^3-4.5901*pcc^2+.2319*pcc+2.5673 data.frame(pcc,lift) %&gt;% mutate(lift=ifelse(lift&lt;1,1,lift)) %&gt;% ggplot(aes(x=pcc, y=lift)) + geom_line(color=&quot;midnightblue&quot;, size=1) + scale_x_continuous(&quot;Proportion Customers Contacted&quot;, limits=c(.05,1), breaks=seq(.1,1,.1)) + scale_y_continuous(&quot;Lift&quot;, limits=c(1,2.6), breaks=seq(1,2.5,.25)) + geom_segment(x=.05, y=1, xend=1, yend=1, color=&quot;red&quot;, size=1) + geom_segment(x=.5, y=1, xend=.5, yend=1.25, arrow=arrow(ends=&quot;first&quot;)) + annotate(&quot;text&quot;, x=.5, y=1.3, label=&quot;Baseline Model&quot;, size=5) + theme(text=element_text(size=15)) + geom_segment(x=.2, y=1, xend=.2, yend=2.452366, linetype=2, color=&quot;darkorange&quot;, size=.75) + geom_segment(x=0, y=2.452366, xend=.2, yend=2.452366, linetype=2, color=&quot;darkorange&quot;, size=.75) 3.5.5 Sensitivity/Specificity Plots Sensitivity, Specificity, and Accuracy depend on the cutoff value for predicting SUCCESS/ FAILURE While 0.5 is the most common threshold, it might not be the best threshold for prediction Looking for: High accuracy Relative balance between specificity and sensitivity Sensitivity/Specificity Plots can show the analyst how each changes with different cutoff values Figure 3.9: Sample Sensitivity/Specificity Plot Code pcc &lt;- seq(0,1,.01) sens &lt;- 1.0189-.01678*pcc-.8349*pcc^2 spec &lt;- 1.9211*pcc-.8349*pcc^2-.0778 acc &lt;- .45+1.6*pcc-1.6*pcc^2 data.frame(pcc, sens, spec, acc) %&gt;% mutate(sens=ifelse(sens&gt;1,1,sens)) %&gt;% mutate(spec=ifelse(spec&lt;0,0,spec)) %&gt;% mutate(spec=ifelse(spec&gt;1,1,spec)) %&gt;% ggplot(aes(x=pcc)) + geom_line(aes(y=acc), color=&quot;red4&quot;, size=1.2) + geom_line(aes(y=sens), color=&quot;forestgreen&quot;, size=.7) + geom_line(aes(y=spec), color=&quot;blue&quot;, size=.7) + geom_point(aes(y=sens), color=&quot;forestgreen&quot;) + geom_point(aes(y=spec), color=&quot;blue&quot;) + scale_x_continuous(&quot;Cutoff Value&quot;, breaks=seq(0,1,.1)) + scale_y_continuous(&quot;Measure Value&quot;, breaks=seq(0,1,.1)) + geom_segment(x=.3, y=.423, xend=.4, yend=.3, arrow=arrow(ends=&quot;first&quot;)) + annotate(&quot;text&quot;, x=.4, y=.28, label=&quot;Specificity&quot;, size=5) + geom_segment(x=.85, y=0.401, xend=.75, yend=.3, arrow=arrow(ends=&quot;first&quot;))+ annotate(&quot;text&quot;, x=.75, y=.28, label=&quot;Sensitivity&quot;, size=5) + geom_segment(x=.2, y=.706, xend=.1, yend=.82, arrow=arrow(ends=&quot;first&quot;))+ annotate(&quot;text&quot;, x=.1, y=.85, label=&quot;Accuracy&quot;, size=5) + theme(text=element_text(size=15)) 3.6 Logistic Regression Example 3.6.1 Overview Purchase data for direct marketing campaign 400 observations of individual responses DV: Purchase made, \\(buy\\) (factor: Yes, No) IVs: Age, \\(age\\) Estimated Salary ($000s), \\(salary\\) Gender, \\(gender\\) (factor: Male, Female) Predict likelihood of purchase Split sample into Training and Holdout 3.6.2 Estimation Results Logit formulation results Table 3.2: Logistic Regression Results (Logit Formulation) Code # Use &#39;splitsample&#39; to get training and test data sp &lt;- splitsample(data=directmktg, outcome=&quot;buy&quot;) train &lt;- sp$train test &lt;- sp$test # Estimate the model on the training data model &lt;- glm(buy ~ age + salary + gender, train, family=&quot;binomial&quot;) summ(model, model.info=FALSE, digits=4) χ²(3) 182.2574 p 0.0000 Pseudo-R² (Cragg-Uhler) 0.6231 Pseudo-R² (McFadden) 0.4638 AIC 218.6842 BIC 233.5126 Est. S.E. z val. p (Intercept) -13.1661 1.6217 -8.1187 0.0000 age 0.2502 0.0321 7.7961 0.0000 salary 0.0406 0.0067 6.0265 0.0000 genderFemale -0.4069 0.3498 -1.1631 0.2448 Standard errors: MLE Odds Ratio Coefficients Table 3.3: Logistic Regression Odds Ratio Coefficients Code summ(model, model.info=FALSE, model.fit=FALSE, digits=4, exp=TRUE) exp(Est.) 2.5% 97.5% z val. p (Intercept) 0.0000 0.0000 0.0000 -8.1187 0.0000 age 1.2843 1.2060 1.3677 7.7961 0.0000 salary 1.0415 1.0278 1.0553 6.0265 0.0000 genderFemale 0.6657 0.3354 1.3215 -1.1631 0.2448 Standard errors: MLE 3.6.3 Overall Model Fit Based on the likelihood ratio \\(\\chi^2\\) test with a \\(p\\text{-value}&lt;.0001\\), the overall model is significant (see Table 3.2) McFadden’s Pseudo-\\(R^2\\) of \\(.464\\) means that the model explains about \\(46\\%\\) of the variation between buyers/non-buyers (see Table 3.2) Classification Matrix for the Training Sample shows: High sensitivity (\\(72.2\\%\\)) High specificity (\\(91.2\\%\\)) High precision (\\(82.1\\%\\)) Correctly classified (\\(84.4\\%\\)) &gt; PCC (\\(54.0\\%\\)) Table 3.4: Classification Matrix for Training Sample Code # NOTE: Saving as result for formatting of online lecture notes cmout &lt;- classify_logistic(MOD=model, # Object with model results DATA=train, # Model data frame POSITIVE=&quot;Yes&quot;, # Factor level for &quot;True&quot; DATA2=test, # Test/holdout data frame LABEL1=&quot;Training Data&quot;, LABEL2=&quot;Test Data&quot;, ft=TRUE) cmout$sample1$table .cl-ecb49194{}.cl-ecad2a58{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ecb06cae{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ecb09bb6{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09bc0{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09bc1{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09bc2{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09bca{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09bcb{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09bd4{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09bd5{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09bde{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09be8{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09be9{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09bf2{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09bf3{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09bf4{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09bfc{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c06{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c07{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c10{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c11{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c1a{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c1b{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c1c{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c24{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c2e{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c2f{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c38{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c39{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c3a{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c42{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c4c{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c4d{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c56{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c60{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c61{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c6a{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ecb09c6b{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Classification Matrix - Training Data (Cutoff = 0.50)Accuracy = 0.844PCC = 0.540ReferencePredictedNoYesTotalNo17630206Yes177895Total193108301Selected Statistics (Positive Class):Sensitivity0.722Specificity0.912Precision0.821 Classification Matrix for the Test/Holdout Sample shows: High sensitivity (\\(77.1\\%\\)) High specificity (\\(90.6\\%\\)) High precision (\\(81.8\\%\\)) Correctly classified (\\(85.9\\%\\)) &gt; PCC (\\(54.3\\%\\)) Table 3.5: Classification Matrix for Test Sample Code cmout$sample2$table .cl-c9719254{}.cl-c9668594{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c96e0b84{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c96e2998{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29a2{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29a3{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29a4{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29ac{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29ad{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29b6{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29b7{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29b8{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29c0{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29ca{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29cb{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29d4{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29d5{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29de{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29df{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29e0{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29e8{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29e9{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29ea{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29f2{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29f3{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29fc{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e29fd{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e2a06{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e2a07{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e2a08{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e2a09{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e2a10{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e2a11{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e2a1a{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e2a1b{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e2a1c{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e2a1d{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e2a24{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c96e2a25{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Classification Matrix - Test Data (Cutoff = 0.50)Accuracy = 0.859PCC = 0.543ReferencePredictedNoYesTotalNo58866Yes62733Total643599Selected Statistics (Positive Class):Sensitivity0.771Specificity0.906Precision0.818 ROC Curve for Training Sample Area \\(&gt;.90\\) suggests an outstanding model fit Figure 3.10: ROC Curve for Training Sample Code rocout &lt;- roc_logistic(MOD=model, # Object with model results DATA=train, # Model data frame DATA2=test, # Test/holdout data frame LABEL1=&quot;Training Data&quot;, LABEL2=&quot;Test Data&quot;) rocout$sample1 ROC Curve for Holdout Sample Area \\(&gt;.90\\) suggests an outstanding model fit Figure 3.11: ROC Curve for Test Sample Code rocout$sample2 3.6.4 Interpreting Coefficients Refer back to Table 3.3 \\(age\\) is positive (\\(OR&gt;1\\)) and significant (\\(p&lt;.001\\)) \\(1\\) year increase in \\(age\\) increases odds of buying by a factor of \\(1.28\\) (or odds of buying increase by \\(25\\%\\)) \\(salary\\) is positive (\\(OR&gt;1\\)) and significant (\\(p&lt;.001\\)) \\(\\$1000\\) increase in \\(salary\\) increases odds of buying by a factor of \\(1.04\\) (or odds of buying increase by \\(4\\%\\)) \\(gender\\) is negative (\\(OR&lt;1\\)), but not significant (\\(p=.245\\)) Had it been significant… Being female decreases odds of buying by a factor of \\(.67\\) (or odds of buying decrease by \\(33\\%\\)) Can visually examine how \\(\\Pr(buy)\\) changes with IVs Figure 3.12: Margin Plot for Age, Salary, and Gender Code # Use &#39;easy_mp&#39; and save plots as objects p1 &lt;- easy_mp(model, focal=&quot;age&quot;)$plot + labs(y=&quot;Pr(Buy)&quot;, x=&quot;Age&quot;) + ylim(0,1) p2 &lt;- easy_mp(model, focal=&quot;salary&quot;)$plot + labs(y=&quot;Pr(Buy)&quot;, x=&quot;Salary&quot;) + ylim(0,1) p3 &lt;- easy_mp(model, focal=&quot;gender&quot;)$plot + labs(y=&quot;Pr(Buy)&quot;, x=&quot;Gender&quot;) + ylim(0,1) # Arrange three plots in a grid using package &#39;cowplot&#39; plot_grid(p1,p2,p3, nrow=2) 3.6.5 Gain Can examine gain for both the training and holdout samples… But using holdout is more informative Contacting the top \\(25\\%\\) of predicted buyers yields nearly \\(60\\%\\) of actual buyers Figure 3.13: Gain Chart for Training and Test/Holdout Samples Code # Use `gainlift_logistic` and save results to oject glresults &lt;- gainlift_logistic(model, train, test, &quot;Yes&quot;) # Request gain plot glresults$gainplot + # Code below for presentation purposes only (NOT USUALLY NECESSARY) annotate(&quot;segment&quot;, x=0.25, y=0, xend=0.25, yend=0.6, linetype=2, linewidth = 1, color=&quot;orange&quot;) + annotate(&quot;segment&quot;, x=0.05, y=0.6, xend=0.25, yend=0.6, linetype=2, linewidth = 1, color=&quot;orange&quot;) + annotate(&quot;segment&quot;, x=0.5, y=0, xend=0.5, yend=0.971, linetype=2, linewidth = 1, color=&quot;brown&quot;) + annotate(&quot;segment&quot;, x=0.05, y=0.974, xend=0.5, yend=0.971, linetype=2, linewidth = 1, color=&quot;brown&quot;) 3.6.6 Lift Can examine gain for both the training and holdout samples… But using holdout is more informative Contacting the top \\(25\\%\\) of predicted buyers provides lift of nearly 2.5 Figure 3.14: Lift Chart for Training and Test/Holdout Samples Code # Request lift plot glresults$liftplot + # Code below for presentation purposes only (NOT USUALLY NECESSARY) annotate(&quot;segment&quot;, x=0.25, y=1, xend=0.25, yend=2.48, linetype=2, linewidth = 1, color=&quot;orange&quot;) + annotate(&quot;segment&quot;, x=0.05, y=2.48, xend=0.25, yend=2.48, linetype=2, linewidth = 1, color=&quot;orange&quot;) + annotate(&quot;segment&quot;, x=0.5, y=1, xend=0.5, yend=1.96, linetype=2, linewidth = 1, color=&quot;brown&quot;) + annotate(&quot;segment&quot;, x=0.05, y=1.96, xend=0.5, yend=1.96, linetype=2, linewidth = 1, color=&quot;brown&quot;) 3.6.7 Sensitivity/Specificity Plots Examine to see if different thresholds are warranted Looking at the plots for both the training sample (see Figure 3.15) and the test/holdout sample (see Figure 3.16), it might be worthwhile to try a cutoff threshold between 0.35 and 0.40 Doing so will balance specificity and sensitivity without hurting accuracy Figure 3.15: Sensitivity/Specificity Plot for Training Sample Code # Use&#39;cutoff_logisit&#39; function on training sample sensspec &lt;- cutoff_logistic(MOD=model, DATA=train, POSITIVE=&quot;Yes&quot;, LABEL1=&quot;Training Sample&quot;, DATA2=test, LABEL2=&quot;Test Sample&quot;, auto_print=FALSE) # Only needed for online lecture materials sensspec$sample1 Figure 3.16: Sensitivity/Specificity Plot for Test/Holdout Sample Code sensspec$sample2 3.7 Suggested Readings R for Marketing Research and Analytics. 2nd Edition (2019). Chapman, Chris; McDonnel Feit, Elea BGSU Library Link:https://librarysearch.bgsu.edu/permalink/01OHIOLINK_BGSU/i5ro6c/alma9926179903408506 Chapter 9.2: Linear Models for Binary Outcomes: Logistic Regression OpenIntro Statistics. 4th Edition (2019). Diez, David; Cetinkaya-Rundel, Mine; Barr, Christopher D. Available at OpenIntro.org:https://www.openintro.org/book/os/ Chapter 9: Multiple and logistic regression Multivariate Data Analysis. Hair, Joseph F.; Black, William C.; Babin, Barry J.; Anderson, Rolph E. 7th Edition: Search for “multivariate data analysis 7th edition hair” Chapter 6: Logistic Regression with a Binary Dependent Variable 5th Edition: Course reserves Chapter 5: Multiple Discriminant Analysis and Logistic Regression (pp. 276-281; 314-321) "],["targeting-and-retaining-customers.html", "Topic 4 Targeting and Retaining Customers 4.1 R Packages and Datasets for Topic 4 4.2 Targeting Customers 4.3 Retaining Customers 4.4 Targeting Customers (Linear Regression) Example 4.5 Targeting Customers (Logistic Regression) 4.6 Suggested Readings", " Topic 4 Targeting and Retaining Customers 4.1 R Packages and Datasets for Topic 4 Code library(ggplot2) # Advanced graphing capabilities library(tidyr) # Easier programming library(GGally) # Scatterplot matrix library(flextable) # Better HTML Tables library(jtools) # Concise regression results library(dplyr) # Easier programming library(vtable) # Nice summary statistics tables library(cowplot) # Arrange plots in grid library(MKT4320BGSU) data(bankmktg) data(telecom) 4.2 Targeting Customers One-to-One Marketing Time consuming Costly Mass Marketing Customer needs not being met Target Marketing Market to those likely to… 4.2.1 Goal Target customers with the highest likelihood of a favorable outcome using explanatory variables Outcome variable could be: Purchase Sales Costs Profitability CLV Explanatory variables could be: Demographics Behaviors Usage Lifestyles The outcome variable will dictate the type of analysis we can perform Continuous outcome variables have a meaningful magnitude Use linear regression Categorical outcome variables do not have a meaningful magnitude Use logistic regression 4.3 Retaining Customers Importance of retention: Reducing defections \\(5\\%\\) boosts profits \\(25\\%\\) to \\(85\\%\\). — Frederick F. Reichheld and W. Earl Sasser, Jr. 4.3.1 Goal Identify factors (i.e., independent variables) that increase the likelihood of retention (or decrease the likelihood of churn) Retention (or Churn) is the outcome or dependent variable DV = Binary, so Method = Logistic Regression 4.4 Targeting Customers (Linear Regression) Example 4.4.1 Overview Customer revenue, usage, and demographics for a cell phone provider DV: Mean monthly revenue (prior 6 months), avg6rev IVs: Mean monthly minutes (prior 6 months), avg6mou Mean monthly customer care calls, cc Mean monthly directory assistance calls, da Mean monthly overage minutes, ovrmou Household income (dollars), income Own home (Yes; No), own 4.4.2 Summarize Data Useful to examine data prior to specifying the model Summary Statistics Table 4.1: Summary Statistics Code # Use &#39;sumtable&#39; from the &#39;vtable&#39; package sumtable(telecom) Table 4.1: Summary Statistics Variable N Mean Std. Dev. Min Pctl. 25 Pctl. 75 Max avg6rev 2382 57 45 2 33 68 726 avg6mou 2382 467 487 0 143 616 5321 cc 2382 1.5 3.8 0 0 1 63 da 2382 0.8 2.1 0 0 0.74 48 ovrmou 2382 41 105 0 0 36 2239 income 2382 64 36 10 38 83 180 own 2382 … No 709 30% … Yes 1673 70% Figure 4.1: Scatterplot Matrix (with Correlations) Code # Use &#39;ggpairs&#39; from the &#39;GGally&#39; package # Pick only the numeric variables from the data using &#39;dplyr&#39; telecom %&gt;% select(-own) %&gt;% ggpairs(lower=list(continuous=&quot;smooth&quot;), # Ask for &quot;regression&quot; line diag=list(continuous=&quot;blankDiag&quot;)) # Set diagonals to be blank 4.4.3 Model Specification Goal: Determine what behaviors and demographics are associated with high revenue customers IVs are expected to be ones that are related to revenue Expect an interaction between home ownership and overage minutes Model: \\[\\begin{align} avg6rev=\\alpha + &amp;\\beta_1avg6mou + \\beta_2cc + \\\\ &amp;\\beta_3da+\\beta_4income + \\\\ &amp;\\beta_5ovrmou+\\beta_6own + \\beta_7(ovrmou\\times own) \\end{align}\\] 4.4.4 Model Interpretation 4.4.4.1 Results Table 4.2: Linear Regression Results Code # Create model and save results to object target &lt;- lm(avg6rev ~ avg6mou + cc + da + income + ovrmou*own, data=telecom) # Use &#39;summ&#39; from &#39;jtools&#39; package for nicer output summ(target, model.info=FALSE, digits=3) F(7,2374) 811.501 R² 0.705 Adj. R² 0.704 Est. S.E. t val. p (Intercept) 33.742 1.436 23.494 0.000 avg6mou 0.049 0.001 35.598 0.000 cc -1.332 0.149 -8.935 0.000 da 1.895 0.268 7.070 0.000 income -0.012 0.014 -0.837 0.403 ovrmou 0.135 0.009 15.516 0.000 ownYes -7.235 1.207 -5.996 0.000 ovrmou:ownYes 0.066 0.010 6.571 0.000 Standard errors: OLS \\[\\begin{align} \\hat{avg6rev} = 33.742 + &amp;.049avg6mou-1.332cc + \\\\ &amp;1.895da - .012income + \\\\ &amp;.135ovrmou - 7.235own + 0.066(ovrmou\\times own) \\end{align}\\] 4.4.4.2 Testing Overall Model Significance Relationship between DV and combined effects of IVs \\(H_0: \\text{all }\\beta_k=0\\) vs. \\(H_a: \\text{at least one }\\beta_k\\ne0\\) Use F-statistic to test Conclusion: With a F-statistic of \\(811.5\\) and a \\(p&lt;.001\\), we conclude that at least one \\(\\beta_k\\) is significant 4.4.4.3 Assessing overall model fit How much variation in the DV is explained by the model Use \\(R^2\\) to assess Use Adjusted \\(R^2\\) to compare models Conclusion: Based on the \\(R^2\\), about \\(70\\%\\) of the variance in avg6rev is explained by the model 4.4.4.4 Interpret Individual IVs Relationship between DV and each IV \\(H_0: \\beta_k=0\\) vs. \\(H_a: \\beta_k\\ne0\\) Interpret significant relationships avg6mou With \\(p&lt;.001\\), avg6mou has a significant effect on avg6rev. A one unit increase in avg6mou is predicted to increase avg6rev by \\(.049\\) units. cc With \\(p&lt;.001\\), cc has a significant effect on avg6rev. A one unit increase in cc is predicted to decrease avg6rev by \\(1.332\\) units. da With \\(p&lt;.001\\), da has a significant effect on avg6rev. A one unit increase in da is predicted to increase avg6rev by \\(1.895\\) units. ovrmou and own interaction With \\(p&lt;.001\\), the effect of ovrmou on avg6rev is significantly different based on own. When the customer owns their home, a one unit increase in ovrmou is predicted to increase avg6rev by \\(.135+.066=.201\\) units. When the customer does notown their home, a one unit increase in ovrmou is predicted to increase avg6rev by \\(.135\\) units. Sometimes helps to visually examine the IVs for interpretation Plots can show predicted DV at different levels of IVs Figure 4.2: Margin Plots for Significant IVs (No Interaction) Code # Use &#39;easy_mp&#39; function from &#39;MKT4320BGSU&#39; package p1 &lt;- easy_mp(target, focal=&quot;avg6mou&quot;, focal_range=c(0,1500))$plot + # Add layers to returned ggplot for nicer looking output ylim(30,120) + # Consistent y-axis limits labs(x=&quot;Mean Monthly Minutes&quot;, y=&quot;Linear Prediction&quot;) p2 &lt;- easy_mp(target, focal=&quot;cc&quot;, focal_range=c(0,10))$plot + # Add layers to returned ggplot for nicer looking output ylim(30,120) + # Consistent y-axis limits labs(x=&quot;Mean Monthly Customer Care Calls&quot;, y=&quot;Linear Prediction&quot;) p3 &lt;- easy_mp(target, focal=&quot;da&quot;, focal_range=c(0,10))$plot + # Add layers to returned ggplot for nicer looking output ylim(30,120) + # Consistent y-axis limits labs(x=&quot;Mean Monthly Directory Assistance Calls&quot;, y=&quot;Linear Prediction&quot;) # Use &#39;plot_grid&#39; from &#39;cowplot&#39; package to combine plots # Need &#39;cowplot::&#39; to force it to use plot_grid from &#39;cowplot&#39; (vs. &#39;sjPlot&#39;) cowplot::plot_grid(p1, p2, p3) Figure 4.3: Margin Plots for Interaction Code # Use &#39;easy_mp&#39; function from &#39;MKT4320BGSU&#39; package p4 &lt;- easy_mp(target, focal=&quot;ovrmou&quot;, int=&quot;own&quot;, focal_range=c(0,300))$plot + # Add layers to returned ggplot for nicer looking output ylim(30,120) + # Consistent y-axis limits labs(x=&quot;Mean Monthly Overage Minutes&quot;, y=&quot;Linear Prediction&quot;, color=&quot;Homeowner&quot;, fill=&quot;Homeowner&quot;) p5 &lt;- easy_mp(target, focal=&quot;own&quot;, int=&quot;ovrmou&quot;, int_range=c(0,300))$plot + # Add layers to returned ggplot for nicer looking output ylim(30,120) + # Consistent y-axis limits labs(x=&quot;Home Ownership&quot;, y=&quot;Linear Prediction&quot;) # Use &#39;plot_grid&#39; from &#39;cowplot&#39; package to combine plots cowplot::plot_grid(p4, p5, nrow=1) Figure 4.4: Margin Plot for Insignificant IV Code # Use &#39;easy_mp&#39; function from &#39;MKT4320BGSU&#39; package easy_mp(target, focal=&quot;income&quot;)$plot + # Add layers to returned ggplot for nicer looking output ylim(30,120) + # Consistent y-axis limits labs(x=&quot;Mean Monthly Minutes&quot;, y=&quot;Linear Prediction&quot;) * Examine deciles of predicted values by the IVs * Split sample into 10 groups based on predicted DV * Look at mean values of IVs for each decile Table 4.3: IVs by Predicted Deciles Code telecom %&gt;% cbind(., yhat=fitted(target)) %&gt;% # Append fitted values to data mutate(yhat.dec=11-ntile(yhat, 10), # Create deciles, but reverse order own=as.numeric(own)-1) %&gt;% # Covert own to 1=yes, 0=no group_by(yhat.dec) %&gt;% # Group by decile summarise(across(avg6rev:own, ~mean(.x, na.rm=TRUE))) %&gt;% # Calculate mean of each IV flextable() # Nice table .cl-94e89d88{}.cl-94df9cce{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-94e244ec{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-94e2692c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94e26936{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-94e26940{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}yhat.decavg6revavg6mouccdaovrmouincomeown1140.894961,445.205883.49299723.21853993233.662815162.112140.5756303279.25630879.621852.53081231.5976575672.021358568.321700.5672269366.10504658.823532.33193280.9872268945.080882466.210070.5924370454.00000479.504201.13865540.6312289924.701680766.728570.5588235549.58403376.966390.96218490.5324369716.087535065.253830.6680672645.59664291.697480.95798320.3871953810.073529463.878730.6428571739.99160224.222690.97058820.275577734.680322162.539750.6890756836.80252154.697480.70868350.206943282.404411858.185780.7478992932.93724110.351460.56624830.154299161.973152060.233790.98744771028.6610951.280331.28033470.045564850.744769961.958180.9916318 4.4.5 Conclusion Recall our Goal: Determine what behaviors and demographics are associated with high revenue customers What did we learn? We can identify our highest revenue customers by examining avg6mou, cc, da, ovrmou and own Our highest revenue customers consumer over \\(1000\\) minutes per month and have over \\(200\\) overage minutes per month More directory assistance calls and fewer customer care calls are associated with higher revenue 4.5 Targeting Customers (Logistic Regression) 4.5.1 Overview Bank marketing data for customers of a bank DV: Open term deposit account, response IVs: Age, age Average Yearly Balance, balance Housing Loan (Yes, No), housing Personal Loan (Yes, No), loan Married (Yes, No), married Predict current customers likely to buy Use training (75%) and holdout (25%) samples 4.5.2 Estimation Results Table 4.4a: Logistic Regression Results on Training Sample (Logit Estimates) Code # Use &#39;splitsample&#39; function to create training and test data sp &lt;- splitsample(bankmktg, &quot;response&quot;, seed = 9999) train &lt;- sp$train test &lt;- sp$test # Estimate using training sample tgt.log &lt;- glm(response ~ age + balance + housing + loan + married, data=train, family=&quot;binomial&quot;) # Use &#39;summ&#39; from &#39;jtools&#39; for nice looking output summ(tgt.log, digits=3, model.info=FALSE) χ²(5) 42.874 p 0.000 Pseudo-R² (Cragg-Uhler) 0.035 Pseudo-R² (McFadden) 0.026 AIC 1598.467 BIC 1633.768 Est. S.E. z val. p (Intercept) -2.345 0.292 -8.041 0.000 age 0.017 0.007 2.545 0.011 balance -0.000 0.000 -0.447 0.655 housingYes -0.467 0.139 -3.360 0.001 loanYes -0.641 0.223 -2.875 0.004 marriedYes -0.548 0.143 -3.838 0.000 Standard errors: MLE Table 4.4b: Logistic Regression Results on Training Sample (Odds Ratio Estimates) Code # Use option &#39;exp=TRUE&#39; for odds ratio estimates summ(tgt.log, digits=3, model.info=FALSE, confint=FALSE, exp=TRUE, model.fit=FALSE) exp(Est.) S.E. z val. p (Intercept) 0.096 0.292 -8.041 0.000 age 1.017 0.007 2.545 0.011 balance 1.000 0.000 -0.447 0.655 housingYes 0.627 0.139 -3.360 0.001 loanYes 0.527 0.223 -2.875 0.004 marriedYes 0.578 0.143 -3.838 0.000 Standard errors: MLE 4.5.3 Overall Model Fit Based on the likelihood ratio test with p-value &lt; .0001, the overall model is significant McFadden’s Pseudo-\\(R^2\\) of .026 means that the model explains only about 3% of variation between buyers/non-buyers Classification Matrix for Training Sample What’s the problem? Table 4.5: Classification Matrix for Training Sample Code # NOTE: Saving as result for formatting of online lecture notes cmout &lt;- classify_logistic(MOD=tgt.log, # Object with model results DATA=train, # Model data frame POSITIVE=&quot;Yes&quot;, # Factor level for &quot;True&quot; DATA2=test, # Test/holdout data frame LABEL1=&quot;Training Data&quot;, LABEL2=&quot;Test Data&quot;, ft=TRUE) cmout$sample1$table .cl-95706236{}.cl-9567a894{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-956bc4f6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-956c0240{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c024a{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c0254{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c025e{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c025f{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c0268{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c0269{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c0272{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c0273{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c0274{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c027c{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c027d{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c0286{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c0287{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c0290{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c0291{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c029a{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c02a4{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c02ae{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c02b8{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c02c2{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c02cc{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c02cd{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c02d6{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c02d7{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c02e0{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c02e1{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c02ea{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c02eb{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c02f4{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c02f5{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c02fe{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c02ff{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c0308{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c0312{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-956c0313{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Classification Matrix - Training Data (Cutoff = 0.50)Accuracy = 0.908PCC = 0.833ReferencePredictedNoYesTotalNo24092442653Yes000Total24092442653Selected Statistics (Positive Class):Sensitivity0.000Specificity1.000Precision Sensitivity/Specificity Plot Figure 4.5: Sensitivity/Specificity Plot for Training Sample Code # Use&#39;cutoff_logisit&#39; function on training sample sensspec &lt;- cutoff_logistic(MOD=tgt.log, DATA=train, POSITIVE=&quot;Yes&quot;, LABEL1=&quot;Training Sample&quot;, DATA2=test, LABEL2=&quot;Test Sample&quot;, auto_print=FALSE) # Only needed for online lecture materials sensspec$sample1 Classification Matrix for Training Sample (0.1 Cutoff) Table 4.5: Classification Matrix for Training Sample Code # NOTE: Saving as result for formatting of online lecture notes cmout &lt;- classify_logistic(MOD=tgt.log, # Object with model results DATA=train, # Model data frame POSITIVE=&quot;Yes&quot;, # Factor level for &quot;True&quot; CUTOFF=0.1, # Use 0.1 for cutoff DATA2=test, # Test/holdout data frame LABEL1=&quot;Training Data&quot;, LABEL2=&quot;Test Data&quot;, ft=TRUE) cmout$sample1$table .cl-9d47f820{}.cl-9d40eb3e{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9d44161a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9d443f14{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f1e{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f28{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f32{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f3c{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f3d{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f46{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f47{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f50{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f51{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f5a{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f64{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f6e{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f6f{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f78{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f82{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f83{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f8c{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f8d{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f96{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f97{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f98{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443f99{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443faa{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443fab{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443fac{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443fb4{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443fb5{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443fb6{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443fbe{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443fbf{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443fc8{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443fd2{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443fd3{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443fdc{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d443fdd{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Classification Matrix - Training Data (Cutoff = 0.10)Accuracy = 0.646PCC = 0.833ReferencePredictedNoYesTotalNo15891181707Yes820126946Total24092442653Selected Statistics (Positive Class):Sensitivity0.516Specificity0.660Precision0.133 Classification Matrix for Holdout Sample (0.1 Cutoff) Results very similar for holdout sample Table 4.6: Classification Matrix for Holdout Sample with 0.1 Cutoff Code cmout$sample2$table .cl-9d5e26ae{}.cl-9d56a000{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9d595944{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9d5976e0{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d5976ea{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d5976eb{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d5976f4{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d5976f5{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d5976fe{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d597708{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d597712{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d597713{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d59771c{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d597726{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d597727{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d597728{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d597730{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d597731{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d59773a{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d59773b{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d59773c{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d597744{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d59774e{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d597758{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d597762{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d597763{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d597764{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d59776c{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d59776d{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d597776{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d597777{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d597780{width:2.679in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d597781{width:0.668in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d59778a{width:0.548in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d597794{width:0.625in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}Classification Matrix - Test Data (Cutoff = 0.10)Accuracy = 0.646PCC = 0.833ReferencePredictedNoYesTotalNo52839567Yes27442316Total80281883Selected Statistics (Positive Class):Sensitivity0.519Specificity0.658Precision0.133 ROC Curve for Holdout Sample Area between \\(.5\\) and \\(.7\\) suggests poor model fit Figure 4.6: ROC Curve for Holdout Sample Code rocout &lt;- roc_logistic(MOD=tgt.log, # Object with model results DATA=train, # Model data frame DATA2=test, # Test/holdout data frame LABEL1=&quot;Training Data&quot;, LABEL2=&quot;Test Data&quot;) rocout$sample2 4.5.4 Interpreting Coefficients age is positive (\\(OR&gt;1\\)) and significant (\\(p=.011\\)) \\(1\\) year increase in age increases odds of buying by a factor of \\(1.017\\) (or odds of buying increase by \\(1.7\\%\\)) married is negative (\\(OR&lt;1\\)) and significant (\\(p&lt;.001\\)) Being married decreases odds of buying by factor of \\(.578\\) (or odds of buying decrease by \\(42.8\\%\\)) housing is negative (\\(OR&lt;1\\)) and significant (\\(p=.001\\)) Having a home loan decreases odds of buying by factor of \\(.627\\) (or odds of buying decrease by \\(37.3\\%\\)) loan is negative (\\(OR&lt;1\\)) and significant (\\(p=.004\\)) Having a personal loan decreases odds of buying by factor of \\(.527\\) (or odds of buying decrease by \\(47.3\\%\\)) 4.5.5 Interpreting Coefficients Visually Figure 4.7: Margin Plots for Significant IVs Code # Use &#39;easy_mp&#39; to create margin plots (with added layers for formatting) lr1 &lt;- easy_mp(tgt.log, focal=&quot;age&quot;)$plot + ylim(0,.3) + labs(x=&quot;Age&quot;, y=&quot;Pr(Response)&quot;) lr2 &lt;- easy_mp(tgt.log, focal=&quot;married&quot;)$plot + ylim(0,.3) + labs(x=&quot;Married&quot;, y=&quot;Pr(Response)&quot;) lr3 &lt;- easy_mp(tgt.log, focal=&quot;loan&quot;)$plot + ylim(0,.3) + labs(x=&quot;Personal Loan&quot;, y=&quot;Pr(Response)&quot;) lr4 &lt;- easy_mp(tgt.log, focal=&quot;housing&quot;)$plot + ylim(0,.3) + labs(x=&quot;Housing Loan&quot;, y=&quot;Pr(Response)&quot;) # Use &#39;plot_grid&#39; to combine cowplot::plot_grid(lr1, lr2, lr3, lr4, nrow=2) 4.5.6 Gain Chart Contacting top \\(20\\%\\) of predicted buyers yields about \\(34\\%\\) of actual buyers Contacting top \\(30\\%\\) of predicted buyers yields about \\(45\\%\\) of actual buyers Figure 4.8: Gain Chart Code # Use &#39;gainlift_logistic&#39; for gain and lift plots glresults &lt;- gainlift_logistic(tgt.log, # Name of the glm results object train, # Name of the training data frame test, # Name of the testing data frame &quot;Yes&quot;) # Level that represents success/true # Output gainplot glresults$gainplot 4.5.7 Lift Chart Contacting top \\(20\\%\\) of predicted buyers provides a lift of about \\(1.7\\) Figure 4.9: Lift Chart Code # Output liftplot glresults$liftplot 4.5.8 Conclusion Recall our goal: Predict current customers likely to buy What did we learn? We can identify those more likely to buy by examining age, married, housing, and loan By targeting those customers that are more likely to purchase, we can better spend our limited resources 4.6 Suggested Readings Marketing Data Science (2015). Miller, Thomas W. BGSU Library Link:https://librarysearch.bgsu.edu/permalink/01OHIOLINK_BGSU/i5ro6c/alma9926167769408506 Chapter 3: Targeting Current Customers "],["segmentation.html", "Topic 5 Segmentation", " Topic 5 Segmentation Coming soon… "],["positioning.html", "Topic 6 Positioning", " Topic 6 Positioning Coming soon… "],["ab-testing-and-uplift-modeling.html", "Topic 7 A/B Testing and Uplift Modeling", " Topic 7 A/B Testing and Uplift Modeling Coming soon… "],["customer-choice.html", "Topic 8 Customer Choice", " Topic 8 Customer Choice Coming soon… "],["marketing-mix.html", "Topic 9 Marketing Mix", " Topic 9 Marketing Mix Coming soon… "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
